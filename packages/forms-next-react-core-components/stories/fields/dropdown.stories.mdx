import { Meta, Story } from '@storybook/addon-docs';
import { AdaptiveForm } from '@aemforms/forms-super-component';
import {decorator, formWithSubmit, logAction} from "../template";
import {
    mappings
} from "../../src";

<Meta title="Adaptive Form/Components/Drop Down"
      component={AdaptiveForm}
      decorators={[decorator]}
      args={{onSubmit: logAction("data")}}
      properties={{viewMode: 'docs'}}
/>

export const Template = (args) => <AdaptiveForm mappings={mappings} formJson={args.formJson} onSubmit={args.onSubmit} />;

# Drop Down List

A drop-down list is a component is a list component to allow selection of one or more items from a list of options. The
spec provides a top level `fieldType` to enable creation of drop down list in the Forms.

The `drop-down` fieldType allows creation of a drop-down list while the options can be provided using the `enum`
property

```json
{
 "fieldType": "drop-down",
  "label": {
    "value": "..."
  },
  "enum": [1, 2, 3, 4]
}
```

<Story
    name="Dropdown Widget"
    args={{
        formJson: formWithSubmit({
            name : "field1",
            fieldType: 'drop-down',
            label: {
                value : "Drop Down List"
            },
            "enum" : [1, 2, 3, 4]
        })
    }} >{Template.bind({})}</Story>

## Option Display Names

By default the options use the enum property to display the text for each option. This can be configured by setting the
[enumNames](https://git.corp.adobe.com/pages/livecycle/af2-docs/spec/latest/index.html#field-properties-enumNames)
property.

```
{
 "fieldType": "drop-down",
  ...
  "enum": [1, 2, 3, 4],
  "enumNames" : ["Option 1", "Option 2", "Option 3", "Option 4"]
}
```

<Story
    name="Option Text"
    args={{
        formJson: formWithSubmit({
            name : "field1",
            fieldType: 'drop-down',
            label: {
                value : "Drop Down List with different text for options"
            },
            "enum" : [1, 2, 3, 4],
            "enumNames" : ["Option 1", "Option 2", "Option 3", "Option 4"]
        })
    }} >{Template.bind({})}</Story>

## Description, Rich Text Label etc.

Similar to Checkbox Group/Text Field the drop-down supports the description and rich text labels

<Story
    name="Description and Rich Text Label"
    args={{
        formJson: formWithSubmit({
            name : "field1",
            fieldType: 'drop-down',
            label: {
                value : "Drop Down with <strong>two options</strong>",
                richText : true
            },
            description : "<em>Rich Text is supported</em> for description as well",
            enum : [1, 2],
            enumNames : ["Option 1", "Option 2"]
        })
    }} >{Template.bind({})}</Story>

## Fetching Options from an end point

Using [initialize](https://git.corp.adobe.com/pages/livecycle/af2-docs/spec/latest/index.html#event-initialize)
event and [request](https://git.corp.adobe.com/pages/livecycle/af2-docs/spec/latest/index.html#request_form_function)
API, options can be fetched from an endpoint and set into the form field.

<Story
    name="Dynamic Options"
    args={{
        formJson: formWithSubmit({
            "name": "countries",
            "type": "string",
            "fieldType": "drop-down",
            "label": {
                "value": "Countries"
            },
            "events": {
                "initialize" : "request('https://countriesnow.space/api/v0.1/countries', 'GET', null, 'countriesLoaded', 'countriesLoadFail')",
                "custom:countriesLoaded": "{ enum : $event.payload.data[*].country}"
            }
        })
    }}>{Template.bind({})}</Story>
